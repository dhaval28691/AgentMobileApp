<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8" />
<!-- <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, target-densitydpi=medium-dpi, user-scalable=0" />
<title>Property</title>
<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/jquery.mobile-1.4.2.min.js"></script>
<script type="text/javascript" src="js/functionspropertyajax.js"></script>

<!--<script type="text/javascript" src="js/cordova.js"></script>-->
<script type="text/javascript" src="js/index.js"></script>

  <!--  <script type="text/javascript" charset="utf-8" src="cordova-2.0.0.js"></script> -->
  <!-- <script type="text/javascript" charset="utf-8" src="js/cardova2.js"></script>
  <script type="text/javascript" charset="utf-8"></script> -->

<link rel="stylesheet" href="css/jquery.mobile-1.4.2.css" />
<link rel="stylesheet" href="css/app_property.css" />
<link rel="stylesheet" href="css/fonts.css" />
<script type="text/javascript">
$(window).load(function() {
   var maxHeight = -1;

   $('.for_sale,.sqr_ft,.house_rate').each(function() {
     maxHeight = maxHeight > $(this).height() ? maxHeight : $(this).height();
   });

   $('.for_sale,.sqr_ft,.house_rate').each(function() {
     $(this).height(maxHeight);
   });
 });	
</script>
</head>
<body>
<script>
  $(document).on({
          ajaxStart: function() { 
            $.mobile.loading('show');
            console.log('getJSON starts...');
          },
          ajaxStop: function() {
            $.mobile.loading('hide');
            console.log('getJSON ends...');
          }    
        });
</script>
  <script type="text/javascript">
    document.addEventListener("backbutton", backKeyDown, true);
    function backKeyDown()
    {
    alert('Are you sure you want to exit');
    }
  </script>
<div data-role="page" id="propertyadd" class="ui-responsive-panel">
	<header class="header-stn"  data-role="header" data-position="fixed">
		<!-- <a href="javascript:history.back()" class="hddiv ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all goback"></a> -->
		<a href="#nav-panel" class="hddiv slide_menu bar" data-icon="bars" data-ajax="false"></a>
		<div class="apn_brf hddiv div">
			<a href="#" class="appoin_brf" data-ajax="false" id="propertylist"><span></span></a>
		</div>
		<div class="apn_apnt hddiv div">
			<a href="#" class="appoin_apnt" title="chat" data-ajax="false" id="testmsg"><span></span></a>
		</div>
		<div class="apn_ple hddiv div">
			<a href="#" class="appoin_ple" title="aboutus" data-ajax="false" id="about1"><span></span></a>
		</div>
		<a href="#" class="slide_menu plus" data-icon="plus" data-ajax="false"  id="testnewprop1"></a>
		<div class="clearing"></div>
	</header>
	<section data-role="content" class="content-container" style="padding:3px;">
	<script type="text/javascript">
	$(document).on('blur', 'input, textarea', function() {
	    setTimeout(function() {
	        window.scrollTo(document.body.scrollLeft, document.body.scrollTop);
	    }, 0);
	});
	</script>
	
		 <div data-role="tabs" class="pstcnt">
			<div data-role="navbar" class="tabbar">
				<ul>
					<!--  <li><a href="#post-property">Post Property</a></li>
					<li><a href="#status">Status</a></li> -->
					<li><a href="#post-property">Property Listing</a></li>
					<li><a href="#status" class="statuscobroke">Co-Broke</a></li>
				</ul>
			</div>
			<div id="post-property" class="post-property1">
			<!--  
				-->
			</div>
			<div id="status" class="status1">
			<!-- 
				    --> 
				</div>
				 
			</div>
		
				
	</section>
	<div data-role="panel" data-position="left" data-position-fixed="false" data-display="overlay" id="nav-panel" class="navpan">
		<div class="myprf">
			<div class="img" id="img1"></div>
			<div class="name"></div><div class="clear"></div>	
		</div>
		<ul data-role="listview" class="clpslst">
			<li><a href="#" class="postpropertylist" data-ajax="false">Property Listings</a></li>
			<li><a href="#" class="managelist">Manage Listing</a></li>
			<li><a href="#" class="messages">Messages</a></li>
			<li><a href="#" class="appointment">Make an Appointment</a></li>
			<li><a href="#" class="news">News</a></li>
		</ul>
		<div class="appshare" id="appshareroot" data-role="collapsible" data-iconpos="right"><h3>APPS</h3>
	   		<ul data-role="listview"><li id="appshare1"><a href="#popupCloseRight" data-rel="popup">share</a><span class="autop"></span></li><li id="apppost1"><a>autopost</a><span class="share"></span></li></ul>
		</div>
		<div class="navprof" id="profile" data-role="collapsible" data-iconpos="right"><h3>Profile</h3>
	   		<ul data-role="listview"><li id="profile1"><a>account settings</a></li><li id="logoutpp"><a>logout</a></li><li id="exitpp"><a>Exit</a></li></ul>
		</div>
		<div data-role="popup" id="popupCloseRight" class="ui-content" style="width:250px">
	    	<a href="#" data-rel="back" class="closemail ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
	    	<input type="text" id="emailshare1"  placeholder="enter the email id..."/>
	    	<a class="sendmail" href="#"><span class="iconmail ui-btn-icon-notext ui-icon-mail"></span><span class="sendtxt">Send</span></a>
		</div>
	</div>
	<!-- <footer data-role="footer" data-position="fixed"></footer> -->
</div>
</body>
</html>

<script type="text/javascript"> 
$(document).ready(function(){
	var userid=getCookie('useridset');

	if(userid=="" || userid==null)
		{
		 alert("Sorry your login expired!");
		 window.location.assign(baseurl()+"/index.html");
		}
	postproperty();

	
function postproperty()
{
	 $('.post-property1').html('');
	$.ajax({
		type: "POST",
		url: baseurl()+"/WS/p_request.php?action=getpostproperty",  //local & server
		//data:"id="+userid,  
		dataType: "json",
		async: 'true',
		success: function(msg) {     
		    if(msg.Result=="Success")   //message from response
		    {
				
		       var json =msg.record;
		       var agentvarid =msg.record7;
		       
		    //   $.mobile.changePage("postproperty.html",{data1:json});   //,reqid:json_req}
		    //     $( document ).on( "pagebeforechange" , function ( event, data ) {
		        	
		        	
		        	 
		 	     //if ( data.toPage[0].id == "propertyadd" ) {
		 	     //var stuff3 = data.options.data1;
		 	     var stuff3=json;
		 	     var data=[];
		 	       $('.post-property1').html('');
		 	      setCookie('propid','');
		 	      
		 	       $.each(stuff3, function(idx, obj) {
		 	         	var price=obj.price;
		 	        	var floor_area=obj.floor_area;
		 	        	var streetname=obj.streetname;
		 	        	var address=obj.address;
		 	        	var front_status=obj.front_status;
		 	        	var description=obj.description;
		 	        	var agent=obj.agent;
		 	        	var media=obj.media;
		 	        	var rooms=obj.rooms;
		 	        	var bathrooms=obj.bathrooms;
		 	        	var listing_type=obj.listing_type;
		 	        	var type=obj.type;
		 	       	    var property_id=obj.property_id;
		 	        	
		 	        	if(media)
		 	        		{
		 	        		
		 	        	    var img_propertylistimage=getCookie('img_propertylistimage');
		 	        	    var img=img_propertylistimage+media;   //dynamic from js
		 	        		}
		 	        	else
		 	        		{
		 	        		//var img="images/background/1.png";
		 	        		var img=baseurl()+"/images/background/noimages.png";
		 	        		}
		 	        	  $.each(agentvarid, function(idx, obj) {
		 	        		 var image=obj.image;
		 	        		 var name=obj.name;
		 	        		 setCookie('agentnamefromp',name);
		 	        		  $('div.name').html(name);
		 	        		 
	 	        		if(image)
	 	        		{
	 	        			
	 	        			var img_agentuserimage=getCookie('img_agentuserimage');
		 	        	    var pimg=img_agentuserimage+image;   //dynamic from js
	 	        		}
	 	        		else
	 	        		{
	 	        			//var pimg="images/profile/1.png";
	 	        			var pimg=baseurl()+"/images/profile/noimages.png";
	 	        		}

	 	        		
	 	        		var imageget='<img src="'+pimg+'" />';
	 	        		 setCookie('agentimagefromp',imageget);
	 	        		 $('div.img').html(imageget);
		 	    	     $(".post-property1").append(

		 	    			//'<div class="ppropertylist">'+
		 	    		

				 	    	
				 	    	'<ul class="post-property">'+
							'<li>'+
							'<a href="#" id="'+property_id+'" class="ppropertylist">'+
				            '<div class="background" style="background: url('+img+')">'+
								'<div class="details">'+
									'<div class="profile">'+
										'<div class="prof_details">'+
											'<div class="profile_picture" id="profilepic">'+										
													'<img src="'+pimg+'" />'+
											'</div>'+
											//'<h1 class="title">'+streetname+'</h1>'+
											'<h1 class="title">'+address+'</h1>'+ /// address is the property name or title/address.
											'<span class="sub_title"></span>'+
										'</div>'+

										'</a>'+

										'<input type="hidden" value="'+property_id+'" id="getp"/>'+
										//'<div class="share"  id="'+property_id+'"></div>'+
										
										'<div class="clearing"></div>'+
									'</div>'+
									'<div class="ediprop" id="editprop" style="display: none;"><a href="#" class="edcnt">Edit</a></div>'+
									'<div class="delprop" id="delprop" style="display: none;"><a href="#" class="decnt">Delete</a></div>'+
									'<div class="clearing"></div>'+
								'</div>'+
								'<div class="details_bottom">'+
									'<div class="for_sale">'+
										//'<h1>'+address+'</h1>'+
										'<h1>'+type+'</h1>'+  //property type name.
										//'<span>'+front_status+'</span>'+
										'<span>'+listing_type+'</span>'+  //not front_status we need for sale/rent....
										'<div class="clearing"></div>'+
									'</div>'+
									'<div class="sqr_ft">'+
										'<div class="sqr_ft_value">'+
											'<span>'+floor_area+'</span>'+
										'</div>'+
										'<div class="bed_rest_room">'+
											'<span class="bhk"></span><span class="bhk_value">'+rooms+'</span>'+
											'<span class="rest"></span><span class="rest_value">'+bathrooms+'</span>'+																				
										'</div>'+									
									'</div>'+		
									'<div class="house_rate">'+
										'<span>'+'$'+price+'</span>'+
									'</div>'+				
								'</div>'+
							'</div>'+
							//here a is there
						'</li>'+
						'</ul>'


						
						//'</div>'
						/////////////
		   			);
		 	        	
		 	        	
		 	        });///for internal
		 	      });  //each end.
		 	       
		 	 //  }   //end of page cond
		 	    
		 	    //before search here
		 	  ///////////////
		 	 //	}); //pagebefore
		 	     
		 	      //view details of list based on property click...
		 	
		 	    $(".ppropertylist").click(function() {
		 	 		
		 	 		   var getpropertyid=$(this).attr('id');
		 	 		
		 	 		  setCookie('propid',getpropertyid);  //to set in property details page.........but not using.
		 	 		  window.location.assign(baseurl()+"/propertydetails.html");
		 	 		
		 	 		  });

				 /////click for share post
                  $(".share").click(function() {
                	 	
     		 	        var width = 626; //626
     		 	        var height = 436; //436

     		 	     
     		 	        
     		 	        var yourPageToShare = location.href;
     		 	        var sharerUrl = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(yourPageToShare);
     		 	        var l = window.screenX + (window.outerWidth - width) / 2;
     		 	        var t = window.screenY + (window.outerHeight - height) / 2;
     		 	        var winProps = ['width='+width,'height='+height,'left='+l,'top='+t,'status=no','resizable=yes','toolbar=no','menubar=no','scrollbars=yes'].join(',');
     		 	        var win = window.open(sharerUrl, 'fbShareWin', winProps);




     		 	       ///to start loader...
     			 	      var your_redirect_uri="http://sghomey.com/property/propertydetails.html";
     			 	    ref.addEventListener('loadstart', function(event) {

     });
     ref.addEventListener('loadstop', function(event) {
        console.log(event.type + ' - ' + event.url);
        var post_id = event.url.split("post_id=")[1];
        var cancel_url = event.url.split("#")[0];
        if(post_id != undefined){
               setTimeout(function() {
                   ref.close();                    
               }, 5000);
        }
        if(cancel_url != undefined && cancel_url == your_redirect_uri){
               setTimeout(function() {
                   ref.close();                        
               }, 1000);
        }                         
     });
     ref.addEventListener('exit', function(event) {

     }); 

     //redirect to app after 5 seconds
     window.setTimeout(function() {
         window.location.href = 'http://sghomey.com/property/propertydetails.html';
     }, 5000);
     			 	    ///
     		 	    //});

     	           

     			 	   
     			 	    ////////////////////
                  });
                     ////////////////////////

				 ///
	      }  //success
		    else
		    {
		      alert("Sorry no property list to view!");
		     // window.location.assign(baseurl()+"/index.html");   //failure
		    }

		                        }, 
		error: function (xhr, ajaxOptions, thrownError) {
		//alert(xhr.status);
		//alert(thrownError);
		alert("Sorry! network problem"); 
		window.location.assign(baseurl()+"/index.html");                      	
		}



		});
//});

	///for cobroke;;;;;;;;;;;;;;

  $(".statuscobroke").click(function() {
 $('.status1').html('');
	$.ajax({
		type: "POST",
		url: baseurl()+"/WS/p_request.php?action=getpostpropertycobroke",  //local & server
		//data:"id="+userid,  
		dataType: "json",
		async: 'true',
		success: function(msg) {     
		    if(msg.Result=="Success")   //message from response
		    {
		       var json =msg.record;
		       var agentvarid =msg.record7;
		       
		    //   $.mobile.changePage("postproperty.html",{data1:json});   //,reqid:json_req}
		    //     $( document ).on( "pagebeforechange" , function ( event, data ) {
		        	
		        	
		        	 
		 	     //if ( data.toPage[0].id == "propertyadd" ) {
		 	     //var stuff3 = data.options.data1;
		 	     var stuff3=json;
		 	     var data=[];
		 	       $('.status1').html('');
		 	      setCookie('propid','');
		 	      
		 	       $.each(stuff3, function(idx, obj) {
		 	         	var price=obj.price;
		 	        	var floor_area=obj.floor_area;
		 	        	var streetname=obj.streetname;
		 	        	var address=obj.address;
		 	        	var front_status=obj.front_status;
		 	        	var description=obj.description;
		 	        	var agent=obj.agent;
		 	        	var media=obj.media;
		 	        	var rooms=obj.rooms;
		 	        	var bathrooms=obj.bathrooms;
		 	        	var listing_type=obj.listing_type;
		 	        	var type=obj.type;
		 	       	    var property_id=obj.property_id;
		 	        	
		 	        	if(media)
		 	        		{
		 	        		
		 	        	    var img_propertylistimage=getCookie('img_propertylistimage');
		 	        	    var img=img_propertylistimage+media;   //dynamic from js
		 	        		}
		 	        	else
		 	        		{
		 	        		var img=baseurl()+"/images/background/noimages.png.png";
		 	        		}
		 	        	  $.each(agentvarid, function(idx, obj) {
		 	        		 var image=obj.image;
		 	        		 var name=obj.name;
		 	        		 setCookie('agentnamefromp',name);
		 	        		  $('div.name').html(name);
		 	        		 
	 	        		if(image)
	 	        		{
	 	        			
	 	        			var img_agentuserimage=getCookie('img_agentuserimage');
		 	        	    var pimg=img_agentuserimage+image;   //dynamic from js
	 	        		}
	 	        		else
	 	        		{
	 	        			var pimg=baseurl()+"/images/profile/noimages.png.png";
	 	        		}
	 	        	
	 	        		var imageget='<img src="'+pimg+'" />';
	 	        		 setCookie('agentimagefromp',imageget);
	 	        		 $('div.img').html(imageget);
		 	    	     $(".status1").append(

		 	    			//'<div class="ppropertylist">'+
		 	    		

				 	    	
				 	    	'<ul class="post-property">'+
							'<li>'+
							'<a href="#" id="'+property_id+'" class="ppropertylist">'+
				            '<div class="background" style="background: url('+img+')">'+
								'<div class="details">'+
									'<div class="profile">'+
										'<div class="prof_details">'+
											'<div class="profile_picture" id="profilepic">'+										
													'<img src="'+pimg+'" />'+
											'</div>'+
											//'<h1 class="title">'+streetname+'</h1>'+
											'<h1 class="title">'+address+'</h1>'+ /// address is the property name or title/address.
											'<span class="sub_title"></span>'+
										'</div>'+

										'</a>'+

										'<input type="hidden" value="'+property_id+'" id="getp"/>'+
										//'<div class="share"  id="'+property_id+'"></div>'+
										
										'<div class="clearing"></div>'+
									'</div>'+
									'<div class="ediprop" id="editprop" style="display: none;"><a href="#" class="edcnt">Edit</a></div>'+
									'<div class="delprop" id="delprop" style="display: none;"><a href="#" class="decnt">Delete</a></div>'+
									'<div class="clearing"></div>'+
								'</div>'+
								'<div class="details_bottom">'+
									'<div class="for_sale">'+
										//'<h1>'+address+'</h1>'+
										'<h1>'+type+'</h1>'+  //property type name.
										//'<span>'+front_status+'</span>'+
										'<span>'+listing_type+'</span>'+  //not front_status we need for sale/rent....
										'<div class="clearing"></div>'+
									'</div>'+
									'<div class="sqr_ft">'+
										'<div class="sqr_ft_value">'+
											'<span>'+floor_area+'</span>'+
										'</div>'+
										'<div class="bed_rest_room">'+
											'<span class="bhk"></span><span class="bhk_value">'+rooms+'</span>'+
											'<span class="rest"></span><span class="rest_value">'+bathrooms+'</span>'+																				
										'</div>'+									
									'</div>'+		
									'<div class="house_rate">'+
										'<span>'+'$'+price+'</span>'+
									'</div>'+				
								'</div>'+
							'</div>'+
							//here a is there
						'</li>'+
						'</ul>'


						
						//'</div>'
						/////////////
		   			);
		 	        	
		 	        	
		 	        });///for internal
		 	      });  //each end.
		 	       
		 	 //  }   //end of page cond
		 	    
		 	    //before search here
		 	  ///////////////
		 	 //	}); //pagebefore
		 	     
		 	      //view details of list based on property click...
		 	 //	   $(".ppropertylist a").click(function() {
		 	    $(".ppropertylist").click(function() {
		 	 		
		 	 		
		 	 		   var getpropertyid=$(this).attr('id');
		 	 		
		 	 		  setCookie('propid',getpropertyid);  //to set in property details page.........but not using.
		 	 		  window.location.assign(baseurl()+"/propertydetails.html");
		 	 		
		 	 		  });

				 /////click for share post
                  $(".share").click(function() {
                	 	///fb link share,,,,,,,,,,,,,
     		 	     
     		 	        var width = 626; //626
     		 	        var height = 436; //436

     		 	       
     		 	        
     		 	        var yourPageToShare = location.href;
     		 	        var sharerUrl = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(yourPageToShare);
     		 	        var l = window.screenX + (window.outerWidth - width) / 2;
     		 	        var t = window.screenY + (window.outerHeight - height) / 2;
     		 	        var winProps = ['width='+width,'height='+height,'left='+l,'top='+t,'status=no','resizable=yes','toolbar=no','menubar=no','scrollbars=yes'].join(',');
     		 	        var win = window.open(sharerUrl, 'fbShareWin', winProps);




     		 	         ///to start loader...
     			 	      var your_redirect_uri=baseurl()+"/postproperty.html";
     			 	    ref.addEventListener('loadstart', function(event) {

     });
     ref.addEventListener('loadstop', function(event) {
        console.log(event.type + ' - ' + event.url);
        var post_id = event.url.split("post_id=")[1];
        var cancel_url = event.url.split("#")[0];
        if(post_id != undefined){
               setTimeout(function() {
                   ref.close();                    
               }, 5000);
        }
        if(cancel_url != undefined && cancel_url == your_redirect_uri){
               setTimeout(function() {
                   ref.close();                        
               }, 1000);
        }                         
     });
     ref.addEventListener('exit', function(event) {

     }); 

     //redirect to app after 5 seconds
     window.setTimeout(function() {
         window.location.href = baseurl()+'/postproperty.html';
     }, 5000);
     			 	    ///
     		 	    //});

     	           

     			 	   
     			 	    ////////////////////
                  });
                     ////////////////////////

				 ///
	      }  //success
		    else
		    {
		      alert("Sorry no property list to view for cobroke type!");
		      //window.location.assign(baseurl()+"/index.html");   //failure
		    }

		                        }, 
		error: function (xhr, ajaxOptions, thrownError) {
		//alert(xhr.status);
		//alert(thrownError);
		alert("Sorry! network problem"); 
		window.location.assign(baseurl()+"/index.html");                      	
		}



		});


	//////////////////co
}
  )}; //cobroke status class click...



///////////////////////////
});



//////////////////////////////////////////////
/*
document.addEventListener('backbutton', backButtonCallback, false);

function backButtonCallback() {
//navigator.notification.confirm('do you want to exit the app?',confirmCallback);
var answer1 = confirm ("Are you sure want to exit the section!");
 		if (answer1)
 		{
 			    setCookie('useridset','');
 				setCookie('usernameset','');
 				setCookie('loginas','');
 				setCookie('userimageset','');
 				setCookie('propid','');
 				setCookie('agentnamefromdb','');
 				setCookie('agentimagefromdb','');
 				
 				///////////////////
 				setCookie('img_propertylistimage','');
 				setCookie('img_agentuserimage','');
 				/////////////////
 		}
 		else
 		{
 	 		
 		}
}
*/
//////////////////////////////
/*
function confirmCallback(buttonIndex) {
if(buttonIndex == 1) {
    navigator.app.exitApp();
    ////////////////
    setCookie('useridset','');
	setCookie('usernameset','');
	setCookie('loginas','');
	setCookie('userimageset','');
	setCookie('propid','');
	setCookie('agentnamefromdb','');
	setCookie('agentimagefromdb','');
	
	///////////////////
	setCookie('img_propertylistimage','');
	setCookie('img_agentuserimage','');
	/////////////////
    return true;
}
else {
    return false;
}

}
*/


/////////////////////////////////////////////////////////

</script>


